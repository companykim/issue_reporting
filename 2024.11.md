# 2024.11.06

## 공통 화면과 관련된 문제

현재 개발서버는 CFD 원장이 마스터 DB이고, BO 원장이 백업용 DB(SLAVE) 같다. </br>
현재 화면을 조회하면 각 화면에 맞는 TR을 호출하는 것이 로그에 남아야 하는데, 실행했을 때, 로그에는 호출했다는 기록이 없다. </br>
등록 및 수정, 삭제에 대해서는 DB에 데이터가 잘 처리가 되고 있다. 다만 기존 테스트용으로 DB에 저장되어 있던 데이터들과 화면상의 데이터와는 차이가 있어서 현재 이에 대한 싱크를 맞추고 있는 상태이다.
이는 현재 공통과 관련된 화면들이 대부분 그럴것으로 추측하고 있다.

STG 서버에서는 BO 원장이 마스터 DB이다. 그래선지 화면을 조회했을 때 각 화면에 맞는 TR이 호출되고 있음을 확인했다.

# 2024.11.14 

## SELECT ~ FOR UPDATE

SELECT ~ FOR UPDATE는 선택된 행들에 대해 배타적으로 LOCK을 거는 것이다. 즉, "데이터 수정하려고 SELECT 했어. 건드리지마!"와 같은 뜻이다.

SELECT FOR UPDATE를 사용하지 않으면 다른 세션에서 업데이트를 하고 잇어도 같은 행을 조회 가능하며, COMMIT을 하기 전까지는 결과가 반영되지 않는다.

### SELECT ~ FOR UPDATE의 옵션 </br>
SELECT ~ FOR UPDATE: 누군가가 LOCK 중이면 무한정 기다려야 한다. </br>
SELECT ~ FOR UPDATE NOWAIT: 누군가가 LOCK 중이면 exception 처리한다. </br>
SELECT ~ FOR UPDATE WAIT 5: 누군가가 LOCK 중이면 입력한 시간(초단위)만큼 기다렸다가 exception 처리한다.

# 2024.11.21

## SUM과 COUNT
COUNT(*) AS TOT_ACC, </br>
IFNULL(SUM(CASE ORD_ABL_YN WHEN '1' THEN 1 ELSE 0 END),0) AS ABL_Y_ACC </br>
총 계좌 개수를 구하는데 count를 쓰는데, 거래 가능 계좌의 개수를 구하는데 sum을 쓰는 것이 이상해서 찾아보았다.

CASE는 조건을 만족하면 1, 만족하지 않으면 0을 반환하는 방식으로 카운팅 논리를 구현한다. </br>
그리고 이 조건에 맞는 숫자를 SUM을 하여 개수를 조회한다. </br>
즉, 잘못된 방식이 아니다.

## dwm_sect
모니터링 화면에는 dwm_sect가 있다. 이는 일간/주간/월간을 나누기 위함이다.

## DISTINCT
중복을 제거하기 위해서 사용하는 함수이며, COUNT와 함께 자주 쓰인다. </br>
SELECT COUNT(DISTINCT 컬럼명) FROM 테이블명 </br>
수량을 반환하는 함수와 같이 사용하면 중복되지 않은 서로 다른 자료갯수를 확인할수 있다.

## STR_TRUNC_CUR
통화코드마다 예수금의 소수점의 자릿수가 다르다. 예를 들어, USD는 소수점 2자리까지 보여주고, BTC는 소수점 8자리까지 보여준다. </br>
이 함수는 그것을 자동으로 변환해준다. 지정된 통화코드에 대해서는 그 통화가 허용하는 자릿수까지 TRUNCATE 해주고, 그 이외의 통화코드에 대해서는 소수점 2자리까지 TRUNCATE 해준다.

## ROI 
투자수익률(Return on Investment)인데, 투자자가 투자 활동을 살펴보고 다른 투자에 비해 특정 투자의 성과가 어떤지 파악하기 위해 사용하는 공식이며, 투자로 인해 얼마를 벌었거나 잃었는지를 보여준다.

## 고시환율
금융기관이나 중앙은행이 외환거래에 사용하기 위해 공식적으로 발표한 환율. 특정 시점의 기준이 되는 환율로, 다양한 외환 거래와 관련된 가격 산정의 기준으로 활용된다.
